
@{
    ViewBag.Title = "AddProduct";
    Layout = "~/Views/Shared/AdminProduct.cshtml";
}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- Content Wrapper -->
<div class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h1 class="m-0 font-weight-bold" style="text-align:center">Nhà sản xuất</h1>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-xl-9 col-lg-10 col-md-12 col-sm-12 mx-auto">
                    <div class="tm-bg-primary-dark tm-block tm-block-h-auto">
                        <div class="row">
                            <div class="col-12">
                                <h2 class="tm-block-title d-inline-block">Thêm nông sản</h2>
                            </div>
                        </div>
                        <div class="row tm-edit-product-row">
                            <div class="col-xl-12 col-lg-12 col-md-12">
                                <form id="frmInputProduct" class="tm-edit-product-form">
                                    <div class="form-group mb-3">
                                        <label for="IDProduct">
                                            Mã nông sản
                                        </label>
                                        <input id="IDProduct"
                                               name="id"
                                               type="text"
                                               class="form-control validate"
                                               required />
                                    </div>
                                    <div class="form-group mb-3">
                                        <label for="name">
                                            Tên nông sản
                                        </label>
                                        <input id="name"
                                               name="nameProduct"
                                               type="text"
                                               class="form-control validate"
                                               required />
                                    </div>
                                    <div class="form-group mb-3">
                                        <label for="name">
                                            Số lượng(kg)
                                        </label>
                                        <input id="number"
                                               name="number"
                                               type="number"
                                               class="form-control validate"
                                               required />
                                    </div>
                                    <div class="form-group mb-3">
                                        <label for="description">Mô tả</label>
                                        <textarea name="details" class="form-control validate"
                                                  rows="3"
                                                  required></textarea>
                                    </div>
                                    @*<div class="col-xl-6 col-lg-6 col-md-12 mx-auto mb-4">
                <div class="tm-product-img-dummy mx-auto" id="blah">
                    <i id="icUpload" class="fas fa-cloud-upload-alt tm-upload-icon" onclick="document.getElementById('fileInput').click();"></i>
                </div>
                <div class="custom-file mt-3 mb-3">
                    <input id="fileInput" type="file" style="display:none;" name="httpPostedFile" />
                    <input type="button"
                           class="btn btn-primary btn-block mx-auto"
                           value="UPLOAD PRODUCT IMAGE"
                           onclick="document.getElementById('fileInput').click();" />
                </div>
            </div>*@
                                    @*<div class="form-group mb-3">
                <label for="category">Category</label>
                <select class="custom-select tm-select-accounts"
                        id="category">
                    <option selected>Select category</option>
                    <option value="1">New Arrival</option>
                    <option value="2">Most Popular</option>
                    <option value="3">Trending</option>
                </select>
            </div>*@        
                                    <input id="setNull" hidden/>
                                    <div class="row">
                                        <div class="form-group mb-3 col-xs-12 col-sm-6">
                                            <label for="expire_date">
                                                Ngày trồng:
                                            </label>
                                            <input id="dateCreated"
                                                   name="dateCreated"
                                                   type="text"
                                                   class="form-control validate"
                                                   data-large-mode="true" />
                                        </div>
                                        <div class="form-group mb-3 col-xs-12 col-sm-6">
                                            <label for="expire_date">
                                                Ngày thu hoạch
                                            </label>
                                            <input id="dateReview"
                                                   name="dateReview"
                                                   type="text"
                                                   class="form-control validate"
                                                   data-large-mode="true" />
                                        </div>
                                    </div>

                                    <div class="form-group mb-3">
                                        <button type="button" class="btn btn-success" onclick="document.getElementById('httpPostFile_id').click()">Chọn hình ảnh</button>
                                        <input class="btn btn-success" id="httpPostFile_id" type="file" name="httpPostedFile" onchange="readURL2(this)" style="display:none" accept="image/*"/>
                                        <img id="blah" src="#" style="display:none; margin-top:2px" />
                                    </div>


                                </form>
                                <div>
                                    <button type="button" onclick="insertProduct();" class="btn btn-primary btn-block text-uppercase">Tạo nông sản</button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function checkRequired() {
        theId = "IDProduct";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập mã nông sản";
        }
        theId = "name";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập tên nông sản";
        }
        theId = "number";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập số lượng";
        }
        theId = "dateCreated";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập ngày trồng";
        }
        theId = "dateReview";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập ngày thu hoạch";
        }
        return "";
    }
</script>
<script>
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                //$('#blah').attr('src', e.target.result);
                debugger
                $('#blah').css('background-image', 'url(' + e.target.result + ')');
                $("#icUpload").css("display", "none");
            }

            reader.readAsDataURL(input.files[0]); // convert to base64 string
        }
    }
    function readURL2(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah')
                    .css("display", "block")
                    .attr('src', e.target.result)
                    .width('100%');
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
    function insertProduct() {
        var errorMes = checkRequired();
        if (errorMes != "") {
            alert(errorMes);
            return;
        }
        //var dateCreated = $("$dateCreated").val();
        //var dateReview = $("dateReview").val();
        //if (dateCreated > dateReview)
        //    alert("Ngày tạo không được sau ngày xem");
        var fd = new FormData(document.getElementById("frmInputProduct"));
        // fd.append('file', input.files[0]);
        $.ajax({
            url: '/Product/InsertProduct',
            data: fd,
            cache: true,
            enctype: "multipart/form-data",
            processData: false,
            contentType: false,
            type: 'POST',
            success: function (data) {
                if (data.Success == true) {
                    alert(data.Message);
                    document.location.href = "/Product/Manager";
                }
                else {
                    alert(data.Message);
                }
                //document.location.href = "/Product/Manager";
            }
        });
    }
</script>


