
@{
    ViewBag.Title = "Registration";
    Layout = "~/Views/Shared/Registration.cshtml";
    var lstArea = this.ViewBag.lst;
}

<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->
<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>

<!------ Include the above in your HEAD tag ---------->
<div class="container" style="margin-top:10%;">
    <form class="form-horizontal col-6 col-sm-9" role="form" id="frmInputInsert">
        <h2>Đăng kí </h2>
        <div class="form-group">
            <label for="Address" class="col-sm-3 control-label">Địa chỉ</label>
            <div class="col-sm-9">
                <input type="text" id="Address" placeholder="Address" name="adrs" class="form-control" autofocus>
            </div>
        </div>
        <div class="form-group">
            <label for="email" class="col-sm-3 control-label">Tỉnh</label>
            <div class="col-sm-9">
                <select id="areaList" onchange="insertCity()" style="height:35px" name="Area" class="form-control">
                    <option selected=""> Chọn tỉnh</option>
                    @foreach (var item in lstArea)
                    {
                        <option value="@item.Title">@item.Title</option>
                    }
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="email" class="col-sm-3 control-label">Thành phố</label>
            <div class="col-sm-9">
                <select id="cityList" style="height:35px" name="City" class="form-control">
                    <option selected=""> Chọn thành phố</option>
                    <option></option>
                </select>
            </div>
        </div>
        @*<div class="form-group">
                <label for="email" class="col-sm-3 control-label">Tỉnh </label>
                <div class="col-sm-9">
                    <select style="height:35px" name="pwd" class="form-control">
                        <option selected=""> Chọn tỉnh</option>
                        @if (lstDetail == null)
                        {
                            <option></option>
                        }
                        else
                        {
                            foreach (var item in lstDetail)
                            {
                                <option value="@item.Title">@item.Title</option>
                            }
                        }
                    </select>
                </div>
            </div>*@
        @if (Session["usernameFB"] != null)
        {
            <div class="form-group">
                <label for="email" class="col-sm-3 control-label">Email* </label>
                <div class="col-sm-9">
                    <input type="email" id="email" placeholder="Email" class="form-control" name="email">
                </div>
            </div>
        }
        <div class="form-group">
            <label for="Telephone" class="col-sm-3 control-label">Số điện thoại</label>
            <div class="col-sm-9">
                <input type="tel" id="telephone" placeholder="telephone" name="phone" class="form-control" autofocus>
            </div>
        </div>
        @*<div class="form-group">
                <label for="Mobilephone" class="col-sm-3 control-label">Mobilephone* </label>
                <div class="col-sm-9">
                    <input type="tel" id="Mobilephone" placeholder="Mobilephone" class="form-control" name="teleNum2">
                </div>
            </div>*@
        @*<div class="form-group">
                <label for="password" class="col-sm-3 control-label">Password*</label>
                <div class="col-sm-9">
                    <input type="password" id="password" placeholder="Password" class="form-control">
                </div>
            </div>
            <div class="form-group">
                <label for="password" class="col-sm-3 control-label">Confirm Password*</label>
                <div class="col-sm-9">
                    <input type="password" id="password" placeholder="Password" class="form-control">
                </div>
            </div>*@
        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">Ngày sinh*</label>
            <div class="col-sm-9">
                <input type="date" id="birthDate" name="birthday" class="form-control">
            </div>
        </div>
        @*<div class="form-group">
                <label for="phoneNumber" class="col-sm-3 control-label">Phone number </label>
                <div class="col-sm-9">
                    <input type="phoneNumber" id="phoneNumber" placeholder="Phone number" class="form-control">
                    <span class="help-block">Your phone number won't be disclosed anywhere </span>
                </div>
            </div>*@
        <div class="form-group">
            <label class="control-label col-sm-3">Vai Trò</label>
            <div class="col-sm-6">
                <div class="row">
                    <div class="col-sm-4">
                        <label class="radio-inline">
                            <input name="idRole" type="radio" id="Farmer" value="1">Nhà sản xuất
                        </label>
                    </div>
                    <div class="col-sm-4">
                        <label class="radio-inline">
                            <input name="idRole" type="radio" id="Distributor" value="2">Nhà vận chuyển
                        </label>
                    </div>
                    <div class="col-sm-4">
                        <label class="radio-inline">
                            <input name="idRole" type="radio" id="Vendor" value="3">Nhà phân phối
                        </label>
                    </div>
                </div>
            </div>
        </div> <!-- /.form-group -->
        <div class="form-group">
            <div class="col-sm-9 col-sm-offset-3">
                <span class="help-block">*Required fields</span>
            </div>
        </div>
        <button type="button" onclick="insert()" class="btn btn-primary btn-block">Register</button>
    </form> <!-- /form -->
</div> <!-- ./container -->
<script>
    function checkRequired() {
        theId = "Address";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập địa chỉ";
        }
        theId = "areaList";
        if (document.getElementById(theId).value == "Chọn tỉnh") {
            document.getElementById(theId).focus();
            return "Vui lòng chọn tỉnh";
        }
        theId = "cityList";
        if (document.getElementById(theId).value == "Chọn thành phố") {
            document.getElementById(theId).focus();
            return "Vui lòng chọn thành phố";
        }
        theId = "telephone";
        if (document.getElementById(theId).value == "") {
            document.getElementById(theId).focus();
            return "Vui lòng nhập số điện thoại";
        }
        const rbs = document.querySelectorAll('input[name="idRole"]');
        let selectedValue = null;
        for (const rb of rbs) {
            if (rb.checked) {
                    selectedValue = rb.value;
                    break;
                }
                }
            if (selectedValue == null) {
                return "Vui lòng chọn vai trò";
            }
            return "";
        }
</script>
<script>
    function insert() {
        var errorMes = checkRequired();
        if (errorMes != "") {
            alert(errorMes);
            return;
        }
        var fd = new FormData(document.getElementById("frmInputInsert"));
        // fd.append('file', input.files[0]);
        $.ajax({
            url: '/User/InsertRegister',
            data: fd,
            processData: false,
            contentType: false,
            type: 'POST',
            success: function (data) {
                document.location.href = "/Home/index";
            }
        });
    }
</script>
<script>
    $('#areaList').change(function () {
        $.ajax({
            url: '/User/GetDetailArea',
            data: { "name": $("#areaList").val() },
            dataType: "json",
            type: "post",
            success: function (data) {
                console.log(data.Success);
                var productsString = "";
                data.Success.forEach(element => {
                    productsString +=
                        `<option value="${element.Title}">${element.Title}</option>">                                       `
                });
                $('#cityList').html(productsString);
            }
        });
    });
</script>

